<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Kled.io Tools</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-top: 2rem;
        }
        .download-card {
            transition: transform 0.3s;
            margin-bottom: 2rem;
        }
        .download-card:hover {
            transform: translateY(-5px);
        }
        .os-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .detected-os {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-5">Download Kled.io Tools</h1>
        
        <div class="detected-os text-center mb-4">
            <p class="mb-2">We detected your operating system as:</p>
            <h3 id="detected-os-name">Detecting...</h3>
            <p class="text-muted">Not correct? Select your OS below.</p>
        </div>

        <div class="row">
            <!-- Windows Downloads -->
            <div class="col-md-4">
                <div class="card download-card" id="windows-card">
                    <div class="card-body text-center">
                        <div class="os-icon">
                            <i class="bi bi-windows"></i>
                        </div>
                        <h3 class="card-title">Windows</h3>
                        <div class="mb-3">
                            <select class="form-select mb-3" id="windows-version">
                                <option value="x64">Windows (64-bit)</option>
                                <option value="x86">Windows (32-bit)</option>
                            </select>
                        </div>
                        <div class="d-grid gap-2">
                            <a href="#" class="btn btn-primary download-btn" data-os="windows" data-tool="desktop">Download Desktop App</a>
                            <div class="dropdown">
                                <button class="btn btn-outline-primary dropdown-toggle w-100" type="button" id="windowsCliDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    Download CLI Tools
                                </button>
                                <ul class="dropdown-menu w-100" aria-labelledby="windowsCliDropdown">
                                    <li><a class="dropdown-item download-btn" href="#" data-os="windows" data-tool="kled">kled</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="windows" data-tool="kcluster">kcluster</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="windows" data-tool="kledspace">kledspace</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="windows" data-tool="kpolicy">kpolicy</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="windows" data-tool="unified-cli">Unified CLI Tool</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- macOS Downloads -->
            <div class="col-md-4">
                <div class="card download-card" id="macos-card">
                    <div class="card-body text-center">
                        <div class="os-icon">
                            <i class="bi bi-apple"></i>
                        </div>
                        <h3 class="card-title">macOS</h3>
                        <div class="mb-3">
                            <select class="form-select mb-3" id="macos-version">
                                <option value="arm64">Apple Silicon (M1/M2)</option>
                                <option value="x64">Intel</option>
                            </select>
                        </div>
                        <div class="d-grid gap-2">
                            <a href="#" class="btn btn-primary download-btn" data-os="macos" data-tool="desktop">Download Desktop App</a>
                            <div class="dropdown">
                                <button class="btn btn-outline-primary dropdown-toggle w-100" type="button" id="macosCliDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    Download CLI Tools
                                </button>
                                <ul class="dropdown-menu w-100" aria-labelledby="macosCliDropdown">
                                    <li><a class="dropdown-item download-btn" href="#" data-os="macos" data-tool="kled">kled</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="macos" data-tool="kcluster">kcluster</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="macos" data-tool="kledspace">kledspace</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="macos" data-tool="kpolicy">kpolicy</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="macos" data-tool="unified-cli">Unified CLI Tool</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Linux Downloads -->
            <div class="col-md-4">
                <div class="card download-card" id="linux-card">
                    <div class="card-body text-center">
                        <div class="os-icon">
                            <i class="bi bi-ubuntu"></i>
                        </div>
                        <h3 class="card-title">Linux</h3>
                        <div class="mb-3">
                            <select class="form-select mb-3" id="linux-version">
                                <option value="x64">Linux (64-bit)</option>
                                <option value="arm64">Linux ARM64</option>
                                <option value="deb">Debian/Ubuntu (.deb)</option>
                                <option value="rpm">Fedora/RHEL (.rpm)</option>
                                <option value="apk">Alpine (.apk)</option>
                            </select>
                        </div>
                        <div class="d-grid gap-2">
                            <a href="#" class="btn btn-primary download-btn" data-os="linux" data-tool="desktop">Download Desktop App</a>
                            <div class="dropdown">
                                <button class="btn btn-outline-primary dropdown-toggle w-100" type="button" id="linuxCliDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    Download CLI Tools
                                </button>
                                <ul class="dropdown-menu w-100" aria-labelledby="linuxCliDropdown">
                                    <li><a class="dropdown-item download-btn" href="#" data-os="linux" data-tool="kled">kled</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="linux" data-tool="kcluster">kcluster</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="linux" data-tool="kledspace">kledspace</a></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="linux" data-tool="kpolicy">kpolicy</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item download-btn" href="#" data-os="linux" data-tool="unified-cli">Unified CLI Tool</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h3>Installation Instructions</h3>
                        <div id="installation-instructions">
                            <p>Select your operating system above to see installation instructions.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h3>API Key Setup</h3>
                        <p>To use the CLI tools in headless mode without the desktop app, you'll need to set up an API key:</p>
                        <pre><code>kled config set-api-key YOUR_API_KEY</code></pre>
                        <p>You can generate an API key from the <a href="#">Kled.io dashboard</a>.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Detect OS
            const userAgent = navigator.userAgent;
            let detectedOS = "Unknown";
            let osCard = null;

            if (userAgent.indexOf("Win") !== -1) {
                detectedOS = "Windows";
                osCard = document.getElementById("windows-card");
            } else if (userAgent.indexOf("Mac") !== -1) {
                detectedOS = "macOS";
                osCard = document.getElementById("macos-card");
            } else if (userAgent.indexOf("Linux") !== -1) {
                detectedOS = "Linux";
                osCard = document.getElementById("linux-card");
            }

            document.getElementById("detected-os-name").textContent = detectedOS;
            
            // Highlight detected OS card
            if (osCard) {
                osCard.classList.add("border-primary");
                osCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            // Handle download buttons
            const downloadButtons = document.querySelectorAll('.download-btn');
            downloadButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const os = this.getAttribute('data-os');
                    const tool = this.getAttribute('data-tool');
                    let version = "x64"; // Default version
                    
                    // Get selected version
                    if (os === "windows") {
                        version = document.getElementById("windows-version").value;
                    } else if (os === "macos") {
                        version = document.getElementById("macos-version").value;
                    } else if (os === "linux") {
                        version = document.getElementById("linux-version").value;
                    }
                    
                    // Generate download URL
                    let downloadUrl = `/api/download?os=${os}&tool=${tool}&version=${version}`;
                    
                    // Show installation instructions
                    updateInstallationInstructions(os, tool, version);
                    
                    // Simulate download (in a real app, this would actually download the file)
                    alert(`Downloading ${tool} for ${os} (${version})...\nURL: ${downloadUrl}`);
                    
                    // In a real implementation, you would redirect to the download URL:
                    // window.location.href = downloadUrl;
                });
            });
            
            // Update installation instructions based on selection
            function updateInstallationInstructions(os, tool, version) {
                const instructionsDiv = document.getElementById('installation-instructions');
                let instructions = '';
                
                if (tool === 'desktop') {
                    if (os === 'windows') {
                        instructions = `
                            <h4>Windows Installation</h4>
                            <ol>
                                <li>Download the installer (.exe)</li>
                                <li>Run the installer and follow the prompts</li>
                                <li>Launch Kled.io from the Start menu</li>
                            </ol>
                        `;
                    } else if (os === 'macos') {
                        instructions = `
                            <h4>macOS Installation</h4>
                            <ol>
                                <li>Download the .dmg file</li>
                                <li>Open the .dmg file</li>
                                <li>Drag Kled.io to your Applications folder</li>
                                <li>Launch Kled.io from your Applications folder</li>
                            </ol>
                        `;
                    } else if (os === 'linux') {
                        if (version === 'deb') {
                            instructions = `
                                <h4>Debian/Ubuntu Installation</h4>
                                <ol>
                                    <li>Download the .deb package</li>
                                    <li>Install with: <code>sudo dpkg -i kled-desktop.deb</code></li>
                                    <li>Launch Kled.io from your applications menu</li>
                                </ol>
                            `;
                        } else if (version === 'rpm') {
                            instructions = `
                                <h4>Fedora/RHEL Installation</h4>
                                <ol>
                                    <li>Download the .rpm package</li>
                                    <li>Install with: <code>sudo rpm -i kled-desktop.rpm</code></li>
                                    <li>Launch Kled.io from your applications menu</li>
                                </ol>
                            `;
                        } else {
                            instructions = `
                                <h4>Linux Installation</h4>
                                <ol>
                                    <li>Download the AppImage</li>
                                    <li>Make it executable: <code>chmod +x kled-desktop.AppImage</code></li>
                                    <li>Run it: <code>./kled-desktop.AppImage</code></li>
                                </ol>
                            `;
                        }
                    }
                } else {
                    // CLI tools
                    if (os === 'windows') {
                        instructions = `
                            <h4>Windows CLI Installation</h4>
                            <ol>
                                <li>Download the executable</li>
                                <li>Add it to your PATH or run it from the download location</li>
                                <li>Open Command Prompt and run: <code>${tool} --help</code></li>
                            </ol>
                        `;
                    } else if (os === 'macos') {
                        instructions = `
                            <h4>macOS CLI Installation</h4>
                            <ol>
                                <li>Download the binary</li>
                                <li>Make it executable: <code>chmod +x ${tool}</code></li>
                                <li>Move it to a directory in your PATH: <code>sudo mv ${tool} /usr/local/bin/</code></li>
                                <li>Run it: <code>${tool} --help</code></li>
                            </ol>
                            <p>Alternatively, install with Homebrew:</p>
                            <pre><code>brew install spectrumwebco/tap/${tool}</code></pre>
                        `;
                    } else if (os === 'linux') {
                        if (version === 'deb') {
                            instructions = `
                                <h4>Debian/Ubuntu CLI Installation</h4>
                                <ol>
                                    <li>Download the .deb package</li>
                                    <li>Install with: <code>sudo dpkg -i ${tool}.deb</code></li>
                                    <li>Run it: <code>${tool} --help</code></li>
                                </ol>
                            `;
                        } else if (version === 'rpm') {
                            instructions = `
                                <h4>Fedora/RHEL CLI Installation</h4>
                                <ol>
                                    <li>Download the .rpm package</li>
                                    <li>Install with: <code>sudo rpm -i ${tool}.rpm</code></li>
                                    <li>Run it: <code>${tool} --help</code></li>
                                </ol>
                            `;
                        } else {
                            instructions = `
                                <h4>Linux CLI Installation</h4>
                                <ol>
                                    <li>Download the binary</li>
                                    <li>Make it executable: <code>chmod +x ${tool}</code></li>
                                    <li>Move it to a directory in your PATH: <code>sudo mv ${tool} /usr/local/bin/</code></li>
                                    <li>Run it: <code>${tool} --help</code></li>
                                </ol>
                                <p>One-line installation:</p>
                                <pre><code>curl -fsSL https://kled.io/install.sh | bash -s -- ${tool}</code></pre>
                            `;
                        }
                    }
                }
                
                instructionsDiv.innerHTML = instructions;
            }
            
            // Initialize with instructions for detected OS
            if (detectedOS === "Windows") {
                updateInstallationInstructions("windows", "desktop", "x64");
            } else if (detectedOS === "macOS") {
                updateInstallationInstructions("macos", "desktop", "arm64");
            } else if (detectedOS === "Linux") {
                updateInstallationInstructions("linux", "desktop", "x64");
            }
        });
    </script>
</body>
</html>
